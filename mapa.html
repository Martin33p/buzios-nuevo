<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mapa Google Maps con Playas</title>
<!-- Estilos CSS -->
  <link rel="stylesheet" href="css/variables.css">

  <link rel="stylesheet" href="css/navegacion.css">
  <link rel="stylesheet" href="css/tarjetas.css">
  <link rel="stylesheet" href="css/botones.css">
  <link rel="stylesheet" href="css/resumen.css">
  
  <link rel="stylesheet" href="css/header.css">
  <link rel="stylesheet" href="css/logo.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
</head>

<body>

  <header id="header">
  <!-- Logo -->
  <img src="imagen/Logotipo.png" alt="Logo de World Travel Turismo" class="logo" />
  
  <!-- Menú -->
  <div class="menu">
    <ul>
      <li><a href="Buzios-Brasil.html"><i class="fas fa-home"></i><span>Inicio</span></a></li>
      <li><a href="index.html"><i class="fas fa-bed"></i><span>Hospedajes</span></a></li>
      <li><a href="mapa.html"><i class="fas fa-map-marker-alt"></i><span>Playas</span></a></li>
      <li><a href="actividades.html"><i class="fa fa-person-walking"></i><span>Actividades</span></a></li>
      <li><a href="ofertas.html"><i class="fas fa-tags"></i><span>Ofertas</span></a></li>
      <li><a href="contacto.html"><i class="fas fa-phone-alt"></i><span>Contacto</span></a></li>
    </ul>
  </div>
</header>
  <style>
/* General body and structure */
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  display: flex;
  flex-direction: column;
  overflow-x: hidden;
}

#header, #footer {
  width: 100%;
}

#map {
  height: 100vh;
  width: 100%;
}

/* Estilo para el info-box */
#info-box {
  position: absolute;
  top: 60vh;
  right: 0;
  width: 100%;
  height: 40vh;
  padding: 10px;
  background-color: rgb(95, 102, 197);
  border-top-left-radius: 10px;
  border-bottom-left-radius: 10px;
  color: white;
  overflow-y: auto;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  text-align: center;
}

#info-box .video {
  display: block;
  margin-top: 10px;
  height: 10px; /* Ajusta la altura del video según lo necesites */
}

.playa-video {
  width: 100%; /* Hace que el video ocupe todo el ancho disponible */
  height: 30%; /* Hace que el video ocupe el 100% de la altura del contenedor */
}

.playa-imagen {
  width: 100%; 
  height: auto; 
  max-height: 200px; 
  object-fit: cover;
}

/* Footer siempre al pie */
#footer {
  margin-top: auto; /* Esto asegura que el footer esté siempre al pie de la página */
  background: linear-gradient(to left, #009739, #f7c600);
  color: white;
  padding: 10px 0;
  text-align: center;
  font-weight: 400;
  font-size: 14px;
  border-top: 3px solid #002776;
}

.footer-contenido {
  max-width: 1200px;
  margin: 0 auto;
}

/* Título flotante sobre el mapa */
#titulo-playa {
  position: absolute;
  top: 50px;  /* Ajusta la posición en la parte superior */
  left: 50%;  /* Centra el título horizontalmente */
  transform: translateX(-20%);  /* Asegura que el título esté centrado */
  z-index: 20;  /* Asegura que el título esté por encima del mapa */
  background-color: rgba(97, 104, 201, 0); /* Fondo semi-transparente */
  color: white;
  padding: 10px;
  font-size: 24px;
  font-weight: bold;
  border-radius: 5px;
  text-align: center;
}
/* Estilo para el enlace "Ver más información" */
.ver-mas-btn {
  display: inline-block;
  margin-top: 260px;
  padding: 10px 20px;
  background-color: #f7c600; /* Color de fondo */
  color: #002776; /* Color del texto */
  font-weight: bold;
  text-align: center;
  text-decoration: none; /* Elimina el subrayado */
  border-radius: 5px; /* Bordes redondeados */
  transition: background-color 0.3s ease, transform 0.3s ease; /* Efectos de transición */
}
.ver-mas-btn:hover {
  background-color: #009739; /* Color de fondo al pasar el mouse */
  color: #fff; /* Color del texto al pasar el mouse */
  transform: scale(1.05); /* Efecto de aumento al pasar el mouse */
}
/* Estilo para la descripción flotante */
#descripcion-flotante {
  position: absolute;
  bottom: 0px;  /* Coloca la descripción al pie del mapa */
  left: 50%;  /* Centra el texto horizontalmente */
  transform: translateX(-50%);  /* Asegura que esté centrado */
  z-index: 210;  /* Asegura que la descripción esté por encima del mapa */
  background-color: rgba(95, 102, 197, 0);  /* Fondo semitransparente */
  color: white;
  padding: 10px;
  font-size: 18px;
  font-weight: normal;
  border-radius: 5px;
  text-align: center;
  max-width: 100%; /* Limita el ancho para que no ocupe toda la pantalla */
  box-sizing: border-box;
  overflow: hidden;  /* Evita desbordes */
  word-wrap: break-word; /* Hace que el texto se ajuste si es demasiado largo */
}
/* En pantallas grandes */
@media (min-width: 768px) {
  #map {
    width: 70%;
    height: 82vh;
    float: left;
  }

  #info-box {
    top: 8.9vh;
    right: 0;
    width: 30%;
    height: 80vh;
    padding: 10px;
    background-color: rgb(95, 102, 197);
    border-top-left-radius: 10px;
    border-bottom-left-radius: 10px;
    color: white;
    overflow-y: auto;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    text-align: center;
  }

  /* Mostrar imágenes y video en pantallas grandes */
  #info-box .imagenes {
    display: flex;
    flex-direction: column; /* Las imágenes se apilan verticalmente */
    gap: 15px; /* Espacio entre imágenes */
  }

  #info-box .video {
    display: block; /* Mostrar video debajo de las imágenes */
  }

  /* No mostrar el video en pantallas grandes, ya que las imágenes son las principales */
  #info-box iframe {
    height: 350px;
  }
}

/* Estilos para pantallas pequeñas */
@media (max-width: 768px) {
  #map {
    height: 50vh;
    width: 100%;
  }

  #info-box {
    top: 55vh;
    height: 35vh;
    width: 100%;
    flex-direction: column;
  }

  /* Mostrar solo el video en pantallas pequeñas */
  #info-box .imagenes {
    display: none; /* Ocultar las imágenes en pantallas pequeñas */
  }

  #info-box .video {
    display: block; /* Mostrar solo el video */
    margin-top: 0px;
  }

  /* Ajustar la altura del video en pantallas pequeñas */
  #info-box iframe {
    height: 258px;
  }
}


  </style>

</head>

<h1 id="titulo-playa" class="titulo-flotante">Haz clic en un marcador para ver detalles.</h1>

  <div id="map"></div>
  <div id="info-box">Haz clic en un marcador para ver detalles.</div>
  

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <script src="script.js" defer></script>
  <script src="alojamientos.js" defer></script>
  <script src="alojamientosCarrusel.js" defer></script>

  <div id="footer"></div>

  <script>
    let map;
    let infoBox = document.getElementById("info-box");
    let playas = [];

    function initMap() {
      const mapContainer = document.getElementById("map");
      if (!mapContainer) {
        console.error("No se encontró el contenedor del mapa.");
        return;
      }

      map = new google.maps.Map(mapContainer, {
        center: { lat: -22.757, lng: -41.884 },
        zoom: 13,
        mapTypeId: 'satellite',
      });

      cargarDatosDesdeSheets();
    }

    async function cargarDatosDesdeSheets() {
      const spreadsheetId = "1zB-BbVoKArPHZa5QslG9XgPXNEM97c40jRIteOu25Po";
      const sheetName = "Playas";
      const url = `https://docs.google.com/spreadsheets/d/${spreadsheetId}/gviz/tq?tqx=out:json&sheet=${sheetName}`;

      try {
        const res = await fetch(url);
        const text = await res.text();
        const json = JSON.parse(text.substring(47).slice(0, -2));
        const rows = json.table.rows;

        playas = rows.map(r => {
          const c = r.c;
          return {
            id: c[0]?.v || "",
            nombre: c[1]?.v || "",
            lat: parseFloat(c[2]?.v) || 0,
            lng: parseFloat(c[3]?.v) || 0,
            descripcion: c[4]?.v || "",
            imagenes: [c[6]?.v, c[7]?.v].filter(v => v && v.trim() !== ""),
            videos: [c[16]?.v].filter(Boolean)
          };
        });

        const filtradas = playas.filter(p => {
          const nombre = p.nombre.toLowerCase();
          return !["hotel", "hostel", "posada", "hospedaje", "pousada"].some(w => nombre.includes(w));
        });

        filtradas.forEach(playa => agregarMarcador(playa));

        const id = new URLSearchParams(window.location.search).get("id");
        if (id) {
          const seleccionada = filtradas.find(p => p.id === id);
          if (seleccionada) mostrarInfo(seleccionada);
        }
      playas.forEach(playa => agregarMarcador(playa));
      } catch (err) {
        console.error("Error cargando datos:", err);
      }
    }

    function agregarMarcador(playa) {
      const marker = new google.maps.Marker({
        position: { lat: playa.lat, lng: playa.lng },
        map,
        title: playa.nombre,
        icon: {
          url: 'assets/Sombrilla.png',
          scaledSize: new google.maps.Size(40, 40),  // Tamaño del icono
        },
      });

      marker.addListener("click", () => mostrarInfo(playa));
    }

function mostrarInfo(playa) {
  if (!infoBox) return;

  // Cambiar el título de la playa al h1 flotante
  const tituloPlayas = document.getElementById('titulo-playa');
  tituloPlayas.innerHTML = playa.nombre;  // Establecer el nombre de la playa como título

  // Construir el HTML de la información
  const imagenes = playa.imagenes
    .filter(img => img && img.trim() !== "")
    .map(img => `<img src="${img}" class="playa-imagen">`)
    .join("");

  const video = playa.videos[0];
  const id = extraerIDVideo(video);
  const videoHtml = id
    ? `<iframe src="https://www.youtube.com/embed/${id}?autoplay=1&loop=1&playlist=${id}&mute=1" frameborder="1" allow="autoplay; encrypted-media" allowfullscreen class="playa-video"></iframe>`
    : "";

  infoBox.innerHTML = `
  <div id="descripcion-flotante">${playa.descripcion}</div>
  <div class="imagenes">${imagenes}</div>
  <div class="video">${videoHtml}</div>
  <a href="playas.html?id=${playa.id}" target="_blank" class="ver-mas-btn">Ver más información</a>
`;

  infoBox.style.display = "block";
  infoBox.scrollIntoView({ behavior: "smooth" });
}




    function extraerIDVideo(url) {
      const match = url.match(/(?:youtube\.com\/(?:[^/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/i);
      return match ? match[1] : null;
    }

    document.addEventListener('DOMContentLoaded', () => {
      cargarDatosDesdeSheets().then(() => {
        const joao = playas.find(p => p.nombre.toLowerCase().includes("joão fernandes"));
        if (joao) mostrarInfo(joao);
      });
    });
    window.addEventListener('DOMContentLoaded', () => {
    fetch("footer.html")
      .then(res => res.text())
      .then(data => {
        document.getElementById("footer").innerHTML = data;
      })
      .catch(error => console.error("Error al cargar el footer:", error));
  });
  </script>

  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAkSFb52hNl90zpqUypv7UoXxE8xdvegdE&callback=initMap&libraries=marker&v=weekly" async defer></script>
 <!-- Footer -->
  
</body>
</html>
